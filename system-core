#!/usr/bin/env bash
# ==========================================================
# üïäÔ∏è SAIH OS ‚Äì Core Installer v0.1
# Carrega o n√∫cleo espiritual e prepara ambiente base
# para transformar o rootfs em sistema operacional SAIH.
# ==========================================================

set -euo pipefail

ROOTFS_DIR="output/rootfs-saih"

if [ ! -d "$ROOTFS_DIR" ]; then
    echo "‚ùå RootFS n√£o encontrado. Execute primeiro:"
    echo "   sudo bash build/debian_base/build-rootfs.sh"
    exit 1
fi

echo "‚õ™ Preparando n√∫cleo do SAIH OS dentro do rootfs..."

sudo chroot "$ROOTFS_DIR" /bin/bash << 'EOF'
echo "üìå Configurando pacotes b√°sicos..."
apt-get update -y
apt-get install -y sudo nano curl wget bash-completion net-tools iputils-ping

echo "‚ú® Criando banner espiritual..."
echo '
=============================
üïäÔ∏è  SAIH OS - Sistema Espiritual 
A Luz que Rompe as Trevas
=============================
' > /etc/motd

echo "üîó Registrando comando SAIH no PATH..."
mkdir -p /usr/local/saih
echo '#!/bin/bash
echo "üïäÔ∏è SAIH OS ‚Äì Presen√ßa Ativa"
' > /usr/local/saih/saih
chmod +x /usr/local/saih/saih
ln -sf /usr/local/saih/saih /usr/bin/saih

echo "Core carregado com sucesso ‚ú®"
EOF

echo "======================================================"
echo "üéâ N√∫cleo Base do SAIH OS configurado!"
echo "Pronto para futuras fases (ISO, Kernel, Desktop)."
echo "======================================================"
